# Инструкция по установке ПО киоска Trovemat
Возможна установка следующих вариантов ПО киоска:
1. [Linux Mint Cinnamon x64](https://linuxmint.com/edition.php?id=237) - версия для тестирования и демонстрации, содержит рабочий стол и легко управляется пользователями с минимальным опытом (или вообще без опыта) работы с операционной системой Linux. Рекомендуется использовать данный вариант, если требуется ознакомительная установка ПО Trovemat.
1. [Ubuntu 16.04 Server x64](http://releases.ubuntu.com/16.04/ubuntu-16.04.3-server-amd64.iso) - версия для использования в промышленной эксплуатации. Содержит все настройки, необходимые для защищённой работы ПО Trovemat.

## Инструкция по установке ПО киоска Trovemat на ОС Linux Mint Cinnamon x64
1. Установка Trovemat производится на операционной системе Linux Mint Cinnamon x64.
1. Установить Trovemat (ввести команду в терминале)  
    
    > !!! ВНИМАНИЕ  
    > !!! ДАННАЯ КОМАНДА УСТАНАВЛИВАЕТ ДЕМОНСТРАЦИОННУЮ ВЕРСИЮ ПО КИОСКА  
    > !!! ДЛЯ ПОЛУЧЕНИЯ ЛИЦЕНЗИОННОЙ ВЕРСИИ БЕЗ ОГРАНИЧЕНИЙ  
    > !!! ОБРАЩАЙТЕСЬ НА sales@trovemat.com  
  
    ``` SHELL 
    wget https://trovemat.com/trovemat_online_installer.sh -O /tmp/trovemat_online_installer.sh && sudo bash /tmp/trovemat_online_installer.sh $USER
    ```
1. Откалибровать сенсорный дисплей: в терминале набрать команду:
    ``` SHELL 
    sudo apt install xinput-calibrator && xinput_calibrator --device {id}
    ```
    id Тачскрина (вводится без фигурных скобок) можно посмотреть после установки Trovemat в списке устройств.
1. Перезагрузить систему, > Trovemat запустится автоматически при загрузке системы.
1. Настроить ПО Trovemat в соответствии с документом ["Инструкция по использованию ПО киоска Trovemat"](https://github.com/trovemat/docs/blob/master/Kiosk/User%20Guide%20%5Bru%5D.md)

## Инструкция по установке ПО киоска Trovemat на ОС Ubuntu 16.04 Desktop x64
1. Установка Trovemat производится на операционной системе Ubuntu 16.04 Desktop x64
    1. Убедитесь в процессе установки что выбрана опция установки "OpenSSH Server".
    1. Установка ОС производится с настройками по умолчанию.
1. Установить Trovemat (ввести команду в терминале)  
    
    > !!! ВНИМАНИЕ  
    > !!! ДАННАЯ КОМАНДА УСТАНАВЛИВАЕТ ДЕМОНСТРАЦИОННУЮ ВЕРСИЮ ПО КИОСКА  
    > !!! ДЛЯ ПОЛУЧЕНИЯ ЛИЦЕНЗИОННОЙ ВЕРСИИ БЕЗ ОГРАНИЧЕНИЙ  
    > !!! ОБРАЩАЙТЕСЬ НА sales@trovemat.com  
  
    ``` SHELL 
    wget https://trovemat.com/trovemat_online_installer_ubuntu.sh
    chmod +x trovemat_online_installer_ubuntu.sh
    sudo ./trovemat_online_installer_ubuntu.sh $USER
    ```
1. По завершении установки Trovemat компьютер будет перезапущен. После перезагрузки системы Trovemat запустится автоматически.
1. Настроить ПО Trovemat в соответствии с документом ["Инструкция по использованию ПО киоска Trovemat"](https://github.com/trovemat/docs/blob/master/Kiosk/User%20Guide%20%5Bru%5D.md)

## Типовой список команд, отправляемых в мессенджере TOX для настройки Trovemat

Настройка терминала производится путем отправки команд из любого клиента Tox.
Прежде чем отправлять команды, необходимо добавить свой "tox id" в Trovemat:
1. Зайти в сервисное меню (последовательное нажатие клавиш на клавиатуре F1 и F2)
1. Нажать на кнопку "Добавить администратора" - первый добавленный администратор будет создан с полными правами, без возможности удаления его из сервисного меню)
1. В клиенте Tox принять заявку в друзья и дождаться, пока Trovemat в Tox’е станет online.

Ниже будут приведены основные команды для первоначальной настройки терминала (в данном документе приведены тестовые данные для настроек). Для более детального понимания процесса настроек необходимо использовать документ ["Инструкция по использованию ПО киоска Trovemat"](https://github.com/trovemat/docs/blob/master/Kiosk/User%20Guide%20%5Bru%5D.md)
Кавычки, которые можно использовать в командах - все виды кавычек, привычные как при работе с мобильными телефонами, так и при работе с Desktop-операционными системами (включая апострофы).

    !!! ВНИМАНИЕ  
    !!! После завершения всех настроек необходимо перезапустить киоск следующей командой: service restart

В указанных командах в угловых скобках указываются те данные, вместо которых необходимо подставлять конкретные значения.

1. Изменить название точки:

		settings set "config.parameters.point_name" "<НАЗВАНИЕ КОНКРЕТНОГО ТЕРМИНАЛА>"
1. Изменить идентификатор терминала:

		settings set "config.parameters.point_id" "<ЦЕЛОЕ ЧИСЛО - ИДЕНТИФИКАТОР ТЕРМИНАЛА>"
1. Сохранить логин и пароль от учетной записи Jetcrypto Wallet:
    1. Логин:

			settings set "config.gateways.jetcrypto_wallet->username" "<ЛОГИН ОТ КОШЕЛЬКА JetCrypto Wallet>"
    1. Пароль:

			settings set -secure "crypto.jetcrypto_wallet_password" "<ПАРОЛЬ ОТ КОШЕЛЬКА JetCrypto Wallet>"
1. Сохранить ключи от выбранной биржи (в качестве примера – биржа Poloniex):
    1. Публичный ключ:
    
			settings set "config.payments.common_params.poloniex_public_key" "<ПУБЛИЧНЫЙ КЛЮЧ ОТ БИРЖИ Poloniex>"
    1. Приватный ключ:
    
			settings set -secure "crypto.poloniex_secret_key" "<ПРИВАТНЫЙ КЛЮЧ ОТ БИРЖИ Poloniex>"
1. Установка ограничений на минимальную и максимальную суммы внесения наличных в рамках одного платежа (по умолчанию минимальная сумма внесения наличных 1, максимальная 15000) в текущей валюте:
    1. Минимальный лимит:
    
			settings set "config.payments.limit_min" "<МИНИМАЛЬНАЯ СУММА ВНЕСЕНИЯ НАЛИЧНЫХ>"
		
			Пример - установим минимальную сумму внесения 200 в текущей валюте: 
			settings set "config.payments.limit_min" "200"
    1. Максимальный лимит:

			settings set "config.payments.limit_max" "<МАКСИМАЛЬНАЯ СУММА ВНЕСЕНИЯ НАЛИЧНЫХ>"
    1. Максимальный лимит внесенных денег на главной странице (по умолчанию 15000) в текущей валюте. Указывается отдельно для каждой фиатной валюты, поддерживаемой купюроприёмником:

			settings set "config.interface.menu.limit_max-><КОД ФИАТНОЙ ВАЛЮТЫ ДЛЯ КОТОРОЙ УСТАНАВЛИВАЕТСЯ ОГРАНИЧЕНИЕ>" "<МАКСИМАЛЬНАЯ СУММА ВНЕСЕНИЯ НАЛИЧНЫХ>"
		
			Пример - установим максимальный лимит 14999 для валюты "RUB": 
			settings set "config.interface.menu.limit_max->RUB" "14999"
			1. Настройка списка доступных для внесения купюр (по умолчанию к приёму доступны все купюры, поддерживаемые купюроприёмником):

		settings set "config.peripherals.validator->enabled_currencies" "<СПИСОК РАЗРЕШЁННЫХ К ПРИЁМУ ВАЛЮТ ИЛИ КУПЮР>"
	
		Пример: разрешить к приёму рублевые купюры номиналов 100, 500, 1000 и 5000:
		settings set "config.peripherals.validator->enabled_currencies" "RUB:100,RUB:500,RUB:1000,RUB:5000"
1. Настройка комиссии:
    1. Задаем условие применение комиссии при внесении суммы от 0 в текущей валюте:
    		
			settings set "config.payments.fee.part->min" "<МИНИМАЛЬНАЯ СУММА ПРИНЯТЫХ НАЛИЧНЫХ, НАЧИНАЯ С КОТОРОЙ ПРИМЕНЯЕТСЯ ДАННОЕ ПРАВИЛО ДЛЯ РАСЧЁТА СУММЫ КОМИССИИ>"
			
			Пример: добавляем правило для применения комиссии начиная с внесённой суммы "0":
			settings set "config.payments.fee.part->min" "0"
    1. Задаем комиссю в % от внесённых наличных денежных средств:
    		
			settings set "config.payments.fee.part->percent" "<ЦЕЛОЕ ЧИСЛОВ - ПРОЦЕНТНАЯ СТАВКА КОМИССИИ>"
		
			Пример: установим комиссию в размере 7% от суммы внесённых денежных средств:
			settings set "config.payments.fee.part->percent" "7"
    1. Задаем фиксированную составляющую комиссии в текущей валюте:
			
			settings set "config.payments.fee.part->fix" "<ЦЕЛОЕ ЧИСЛОВ - ФИКСИРОВАННАЯ СОСТАВЛЯЮЩАЯ КОМИССИИ>"
		
			Пример: установим фиксированную часть комиссии 50 в текущей валюте:
			settings set "config.payments.fee.part->fix" "<ЦЕЛОЕ ЧИСЛОВ - ФИКСИРОВАННАЯ СОСТАВЛЯЮЩАЯ КОМИССИИ>"
1. Изменяем параметры терминала (название, адрес и т.д.):
    1. Имя дилера:
    
			settings set "config.point_info.dealer_name->name" "<НАИМЕНОВАНИЕ КОМПАНИИ ВЛАДЕЛЬЦА ТЕРМИНАЛА>"
    1. Адрес дилера:
    
    		settings set "config.point_info.dealer_address->name" "<ЮРИДИЧЕСКИЙ АДРЕС КОМПАНИИ ВЛАДЕЛЬЦА ТЕРМИНАЛА>"
    1. Номер телефона дилера:
    
    		settings set "config.point_info.dealer_phone->name" "<НОМЕР ТЕЛЕФОНА ВЛАДЕЛЬЦА ТЕРМИНАЛА>"
    1. Адрес точки, где расположен данный терминал:
    
    		settings set "config.point_info.point_address->name" "<ФАКТИЧЕСКИЙ АДРЕС УСТАНОВКИ ТЕРМИНАЛА>"    

!!! ВНИМАНИЕ  
!!! После завершения всех настроек необходимо перезапустить киоск следующей командой: service restart
